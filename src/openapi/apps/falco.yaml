AppFalco:
  additionalProperties: false
  type: object
  properties:
    id:
      $ref: ../definitions.yaml#/idName
    enabled:
      type: boolean
      default: false
    rawValues:
      $ref: ../definitions.yaml#/rawValues
    values:
      x-externalDocsPath: docs/apps/falco
      additionalProperties: false
      type: object
      properties:
        driver:
          type: string
          description: Choose between module (kernel driver), ebpf (eBPF probe), modern-bpf (modern eBPF probe).
          title: Driver settings
          default: ebpf
          enum:
            - module
            - ebpf
            - modern-bpf
        resources:
          type: object
          properties:
            falco:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 1000m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 512Mi
              required:
                - limits
                - requests
            falcoExporter:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 50m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 32Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 20m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 16Mi
              required:
                - limits
                - requests
  required: [id]
