AppKeycloak:
  additionalProperties: false
  x-externalDocsPath: https://www.keycloak.org
  x-short: Open Source Identity and Access Management
  description: Add authentication to applications and secure services with minimum effort. No need to deal with storing users or authenticating users. Keycloak provides user federation, strong authentication, user management, fine-grained authorization, and more.
  title: Keycloak
  type: object
  properties:
    id:
      $ref: ../definitions.yaml#/idName
    enabled:
      default: true
      type: boolean
    rawValues:
      $ref: ../definitions.yaml#/rawValues
    shortcuts:
      description: Resource URL that lands the user in a place of interest within an app.
      type: array
      nullable: true
      items:
        $ref: ../definitions.yaml#/shortcut
    values:
      x-externalDocsPath: docs/console/apps/keycloak
      additionalProperties: false
      type: object
      properties:
        idp:
          additionalProperties: false
          properties:
            alias:
              type: string
              default: otomi-idp
            clientID:
              $ref: ../definitions.yaml#/wordCharacterPattern
              default: otomi
            clientSecret:
              type: string
              x-secret: 'randAlphaNum 32'
        postgresqlPassword:
          type: string
          description: Once set and deployed it cannot be changed with manual intervention.
          x-secret: 'randAlphaNum 20'
        adminUsername:
          type: string
          default: admin
        adminPassword:
          $ref: ../definitions.yaml#/adminPassword
        resources:
          additionalProperties: false
          properties:
            keycloak:
              properties:
                limits:
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      x-default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      x-default: 1.5Gi
                requests:
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      x-default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      x-default: 1Gi
              required:
                - limits
                - requests
            postgresql:
              properties:
                limits:
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      x-default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      x-default: 1.5Gi
                requests:
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      x-default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      x-default: 1Gi
              required:
                - limits
                - requests
        theme:
          enum:
            - default
            - otomi
          type: string
          default: otomi
      required:
        - postgresqlPassword
