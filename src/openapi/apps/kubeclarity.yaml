AppKubeclarity:
  additionalProperties: false
  type: object
  properties:
    id:
      $ref: ../definitions.yaml#/idName
    enabled:
      type: boolean
      default: false
    rawValues:
      $ref: ../definitions.yaml#/rawValues
    shortcuts:
      description: Resource URL that lands the user in a place of interest within an app.
      type: array
      nullable: true
      items:
        $ref: ../definitions.yaml#/shortcut
    values:
      x-externalDocsPath: docs/apps/kubeclarity
      type: object
      properties:
        analyser:
          title: Analyser config
          description: Select the analyser(s) to use. syft gomod are enabled by default
          properties:
            trivy:
              enabled:
                type: boolean
                default: false
        scanner:
          title: Scanner config
          description: Select the scanner(s) to use.
          properties:
            grype:
              enabled:
                type: boolean
                default: true
                readOnly: true
            trivy:
              enabled:
                type: boolean
                default: false
        resources:
          additionalProperties: false
          type: object
          properties:
            kubeclarity:
              title: Kubeclarity
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
            cdbScanner:
              title: Cis Docker Benchmark Scanner
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 50m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 50Mi
            vulnerabilityScanner:
              title: Vulnerability Scanner
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 50m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 50Mi
            grypeServer:
              title: KubeClarity Grype Server
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 200m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
            trivyServer:
              title: KubeClarity Trivy Server
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 200m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
            sbomDb:
              title: KubeClarity SBOM DB
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 100Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 10m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 20Mi
            postgresql:
              title: KubeClarity Internal Postgres
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 250m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 256Mi
        databasePassword:
          type: string
          description: Once set and deployed it cannot be changed with manual intervention.
          x-secret: 'randAlphaNum 20'
      required:
        - databasePassword
  required: [id]
