lokiValues:
  type: object
  properties:
    adminPassword:
      type: string
      x-secret: 'randAlphaNum 20'
    retention:
      properties:
        duration:
          default: 24h
          type: string
        period:
          default: 24h
          description: Should be a multiple of 24h. See https://grafana.com/docs/loki/latest/operations/storage/boltdb-shipper/.
          type: string
      required:
        - duration
    v11StartDate:
      description: Set this to a date just after deployment in case of an upgrade.
      title: Schema v11 start date
      type: string
    persistence:
      type: object
      properties:
        ingester:
          type: object
          properties:
            size:
              default: 20Gi
              type: string
        querier:
          type: object
          properties:
            size:
              default: 20Gi
              type: string
    autoscaling:
      type: object
      properties:
        ingester:
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            maxReplicas:
              type: integer
              default: 3
            minReplicas:
              type: integer
              default: 1
            targetCPUUtilizationPercentage:
              type: integer
              default: 80
            targetMemoryUtilizationPercentage:
              type: integer
              default: 80
        gateway:
          additionalProperties: false
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            maxReplicas:
              type: integer
              default: 3
            minReplicas:
              type: integer
              default: 1
            targetCPUUtilizationPercentage:
              type: integer
              default: 80
            targetMemoryUtilizationPercentage:
              type: integer
              default: 80
        querier:
          additionalProperties: false
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            maxReplicas:
              type: integer
              default: 3
            minReplicas:
              type: integer
              default: 1
            targetCPUUtilizationPercentage:
              type: integer
              default: 80
            targetMemoryUtilizationPercentage:
              type: integer
              default: 80
        distributor:
          additionalProperties: false
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            maxReplicas:
              type: integer
              default: 3
            minReplicas:
              type: integer
              default: 1
            targetCPUUtilizationPercentage:
              type: integer
              default: 80
            targetMemoryUtilizationPercentage:
              type: integer
              default: 80
        queryFrontend:
          additionalProperties: false
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            maxReplicas:
              type: integer
              default: 3
            minReplicas:
              type: integer
              default: 1
            targetCPUUtilizationPercentage:
              type: integer
              default: 80
            targetMemoryUtilizationPercentage:
              type: integer
              default: 80
    resources:
      additionalProperties: false
      type: object
      properties:
        compactor:
          properties:
            limits:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 200m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 256Mi
            requests:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 50m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 128Mi
          required:
            - limits
            - requests
        ingester:
          properties:
            limits:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 500m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 1Gi
            requests:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 50m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 128Mi
          required:
            - limits
            - requests
        gateway:
          properties:
            limits:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 200m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 256Mi
            requests:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 50m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 64Mi
          required:
            - limits
            - requests
        querier:
          properties:
            limits:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 200m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 256Mi
            requests:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 50m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 64Mi
          required:
            - limits
            - requests
        distributor:
          properties:
            limits:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 200m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 256Mi
            requests:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 50m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 64Mi
          required:
            - limits
            - requests
        queryFrontend:
          properties:
            limits:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 200m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 256Mi
            requests:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 50m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 64Mi
          required:
            - limits
            - requests
  required:
    - adminPassword

AppLoki:
  additionalProperties: false
  type: object
  properties:
    id:
      $ref: ../definitions.yaml#/idName
    enabled:
      type: boolean
      default: true
    rawValues:
      $ref: ../definitions.yaml#/rawValues
    shortcuts:
      description: Resource URL that lands the user in a place of interest within an app.
      type: array
      nullable: true
      items:
        $ref: ../definitions.yaml#/shortcut
    values:
      type: object
      x-externalDocsPath: docs/apps/loki
      $ref: '#/lokiValues'
  required: [id]
