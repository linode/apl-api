AppThanos:
  additionalProperties: false
  type: object
  properties:
    id:
      $ref: ../definitions.yaml#/idName
    enabled:
      type: boolean
      default: false
    rawValues:
      $ref: ../definitions.yaml#/rawValues
    values:
      x-externalDocsPath: docs/apps/thanos
      type: object
      properties:
        query:
          description: Thanos query parameters
          properties:
            replicaCount:
              description: Number of Thanos Receive replicas.
              type: integer
              default: 1
        receiver:
          description: Thanos receiver parameters
          properties:
            mode:
              description: Mode to run receiver in.
              type: string
              default: standalone
              enum:
                - standalone
                - dual-mode
            replicaCount:
              description: Number of Thanos Receiver replicas.
              type: integer
              default: 1
            tsdbRetention:
              description: How long to retain raw samples on local storage. 0d - disables this retention.
              type: string
              default: 7d
            replicationFactor:
              description: How many times to replicate incoming write requests.
              type: integer
              default: 1
        receiverDistributor:
          description: Thanos Receiver distributer parameters
          properties:
            enabled:
              type: boolean
              default: true
        compactor:
          description: Resolution and Retention flags.
          properties:
            retentionResolutionRaw:
              type: string
              default: 30d
            retentionResolution5m:
              type: string
              default: 60d
            retentionResolution1h: 
              type: string
              default: 0s
        ruler:
          properties:
            enabled:
              type: boolean
              default: false
        objstore:
          additionalProperties: false
          type: object
          properties:
            storageProvider:
              type: object
              title: Storage providers
              description: Configure the Thanos object store.
              oneOf:
                - title: Local Minio
                  type: object
                  description: For using local cluster Minio instance.
                  properties:
                    type:
                      type: string
                      enum:
                        - minioLocal
                      default: minioLocal
                - title: S3
                  type: object
                  x-hideTitle: true
                  properties:
                    s3:
                      type: object
                      title: S3
                      description: AWS S3 or S3 compatible blob storage.
                      properties:
                        bucket:
                          type: string
                          description: The name of the bucket
                          $ref: ../definitions.yaml#/wordCharacterPattern
                        s3Url:
                          type: string
                          description: S3 URL
                          $ref: ../definitions.yaml#/wordCharacterPattern
                        accessKeyId:
                          type: string
                          description: The ID of the access key
                          $ref: ../definitions.yaml#/wordCharacterPattern
                        secretAccessKey:
                          type: string
                          description: The secret of the access key
                          $ref: ../definitions.yaml#/wordCharacterPattern
                          x-secret: ''
                      required:
                        - accessKeyId
                        - secretAccessKey
                        - bucket
                        - s3Url
                    type:
                      type: string
                      enum:
                        - s3
                      default: s3
                  required:
                    - s3
                    - type
        persistence:
          additionalProperties: false
          type: object
          properties:
            receiver:
              type: object
              title: Receive
              properties:
                size: 
                  type: string
                  default: 50Gi
            storegateway:
              description: Store gateway
              type: object
              properties:
                size: 
                  type: string
                  default: 8Gi
            compactor:
              description: Compactor
              type: object
              properties:
                size: 
                  type: string
                  default: 8Gi
            ruler:
              description: Ruler
              type: object
              properties:
                size: 
                  type: string
                  default: 8Gi
        resources:
          additionalProperties: false
          type: object
          properties:
            query:
              title: Query
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 500m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 256Mi
              required:
                - limits
                - requests
            queryFrontend:
              title: Query Frontend
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 500m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 512Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 128Mi
              required:
                - limits
                - requests
            receiver:
              description: Receive
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 2Gi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 200m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 512Mi
              required:
                - limits
                - requests
            receiverDistributor:
              description: Receiver Distributer
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 512Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 128Mi
              required:
                - limits
                - requests
            storegateway:
              description: Store Gateway
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 500m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 256Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 128Mi
              required:
                - limits
                - requests
            bucketweb:
              description: Bucket Web
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 128Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 50m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 64Mi
              required:
                - limits
                - requests
            compactor:
              description: Compactor
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: '1'
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 512Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 128Mi
              required:
                - limits
                - requests
            ruler:
              description: Ruler
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 500m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 512Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 256Mi
              required:
                - limits
                - requests