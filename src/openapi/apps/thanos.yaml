AppThanos:
  additionalProperties: false
  type: object
  properties:
    id:
      $ref: ../definitions.yaml#/idName
    enabled:
      type: boolean
      default: false
    rawValues:
      $ref: ../definitions.yaml#/rawValues
    values:
      x-externalDocsPath: docs/apps/thanos
      additionalProperties: false
      type: object
      properties:
        query:
          description: Thanos query parameters
          properties:
            resources:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 1000m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1000Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
              required:
                - limits
                - requests
            replicaCount:
              description: Number of Thanos Receive replicas.
              type: integer
              default: 1
        queryFrontend:
          description: Thanos query front-end parameters
          properties:
            resources:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 1000m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1000Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
              required:
                - limits
                - requests
        receiver:
          description: Thanos receiver parameters
          properties:
            resources:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 1000m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1000Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
              required:
                - limits
                - requests
            mode:
              description: Mode to run receiver in.
              type: string
              default: standalone
              enum:
                - standalone
                - dual-mode
            replicaCount:
              description: Number of Thanos Receive replicas.
              type: integer
              default: 1
            persistence:
              properties:
                size: 
                  type: string
                  default: 8Gi
        storegateway:
          description: Store gateway configuration
          properties:
            resources:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 1000m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1000Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
              required:
                - limits
                - requests
            persistence:
              properties:
                size: 
                  type: string
                  default: 8Gi  
        bucketweb:
          properties:
            resources:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 1000m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1000Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
              required:
                - limits
                - requests
        compactor:
          description: Resolution and Retention flags.
          properties:
            retentionResolutionRaw:
              type: string
              default: 30d
            retentionResolution5m:
              type: string
              default: 30d
            retentionResolution1h: 
              type: string
              default: 10y
            persistence:
              properties:
                size: 
                  type: string
                  default: 8Gi
        ruler:
          properties:
            enabled:
              type: boolean
              default: false
            resources:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 1000m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 1000Mi
                requests:
                  type: object
                  properties:
                    cpu:
                      $ref: ../definitions.yaml#/quantityCpu
                      default: 100m
                    memory:
                      $ref: ../definitions.yaml#/quantityMem
                      default: 200Mi
              required:
                - limits
                - requests
            persistence:
              properties:
                size: 
                  type: string
                  default: 8Gi
        objstore:
          additionalProperties: false
          type: object
          title: Storage providers
          description: Configure the Thanos object store.
          oneOf:
            - title: minioLocal
              type: object
              description: For using local cluster Minio instance.
              properties:
                storageProvider:
                  type: string
                  enum:
                    - minioLocal
                  default: minioLocal
            - title: s3Like
              type: object
              description: For storing backups in S3
              properties:
                s3:
                  additionalProperties: false
                  type: object
                  properties:
                    bucket:
                      type: string
                      description: The name of the bucket
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    s3Url:
                      type: string
                      description: S3 URL
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    accessKeyId:
                      type: string
                      description: The ID of the access key
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    secretAccessKey:
                      type: string
                      description: The secret of the access key
                      $ref: ../definitions.yaml#/wordCharacterPattern
                      x-secret: ''
                  required:
                    - accessKeyId
                    - secretAccessKey
                    - bucket
                    - s3Url
                storageProvider:
                  type: string
                  enum:
                    - s3Like
                  default: s3Like
              required:
                - s3
                - storageProvider



