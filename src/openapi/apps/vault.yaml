AppVault:
  additionalProperties: false
  type: object
  properties:
    id:
      $ref: ../definitions.yaml#/idName
    enabled:
      type: boolean
      default: false
    rawValues:
      $ref: ../definitions.yaml#/rawValues
    shortcuts:
      description: Resource URL that lands the user in a place of interest within an app.
      type: array
      nullable: true
      items:
        $ref: ../definitions.yaml#/shortcut
    values:
      x-externalDocsPath: docs/apps/vault
      additionalProperties: false
      type: object
      properties:
        logLevel:
          $ref: ../definitions.yaml#/logLevel
        seal:
          description: |
            Use a KMS to encrypt and decrypt the master key.\n
            WARNING - You must first copy the keys from the "vault-unseal-keys" secret, and import them to your KMS.\n
            (enabling this feature will delete the unseal key from the cluster without pushing to external kms!)
          nullable: true
          type: object
          oneOf:
            - $ref: ../definitions.yaml#/offChoice
            - title: gcpckms
              type: object
              properties:
                gcpckms:
                  properties:
                    project:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    region:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    key_ring:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    kmsAccount:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                  required:
                    - project
                    - region
                    - key_ring
                    - kmsAccount
              required:
                - gcpckms
            - title: awskms
              type: object
              properties:
                awskms:
                  properties:
                    region:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    access_key:
                      type: string
                    secret_key:
                      type: string
                      x-secret: ''
                    endpoint:
                      type: string
                  required:
                    - region
                    - access_key
                    - secret_key
                    - endpoint
              required:
                - awskms
            - title: azurekeyvault
              type: object
              properties:
                azurekeyvault:
                  properties:
                    vault_name:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    tenant_id:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    client_id:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                    client_secret:
                      type: string
                      x-secret: ''
                    key_name:
                      $ref: ../definitions.yaml#/wordCharacterPattern
                  required:
                    - vault_name
                    - tenant_id
                    - client_id
                    - client_secret
                    - key_name
              required:
                - azurekeyvault
        storage:
          description: Storage configuration. See https://www.vaultproject.io/docs/configuration/storage. Defaults to PVC.
          type: object
        # image:
        #   type: object
        #   properties:
        #     tag:
        #       $ref: ../definitions.yaml#/imageTag
        #       default: 1.14.4
        resources:
          type: object
          properties:
            limits:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 1000m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 512Mi
            requests:
              type: object
              properties:
                cpu:
                  $ref: ../definitions.yaml#/quantityCpu
                  default: 500m
                memory:
                  $ref: ../definitions.yaml#/quantityMem
                  default: 256Mi
          required:
            - limits
            - requests
  required: [id]
