# Please leave the following line so yaml-language-server doesn't incorrectly validate this file according to its cluster.yaml schema:
# yaml-language-server: $schema=https://raw.githubusercontent.com/json-schema-org/json-schema-spec/draft-04/schema.json
apiName:
  title: API name
  description: Used by kubecontext. Also used by API/UI to show in app.
  type: string
apiserver:
  title: API server
  description: Used by kubectl for local deployment to target cluster.
  type: string
domainSuffix:
  title: Domain suffix
  $ref: definitions.yaml#/domain
  description: Domain suffix for the cluster. Also added to list of dns zones in the Otomi Console.
entrypoint:
  title: Entrypoint
  description: Enter the `kube-apiserver` public IP address (onprem only).
  type: string
name:
  title: Name
  description: A cluster name.
  type: string
owner:
  title: Name
  descrption: A cluster owner. Used in alerts/reports to distinguish between resources for different customers.
  type: string
provider:
  title: Provider
  description: Enter the cloud provider of this cluster.
  type: string
  enum:
    - aws
    - azure
    - google
    - onprem
region:
  title: Region
  description: Enter the region of the cluster for its cloud provider.
  type: string
vpcID:
  title: VPC ID
  description: AWS only. If provided, this property will override the autodiscovery from metadata.
  type: string

AdditionalCluster:
  additionalProperties: false
  x-acl:
    admin:
      - read
      - update
      - create
      - delete
    team:
      - read
  title: Additional cluster
  description: A k8s cluster managed by Otomi.
  properties:
    domainSuffix:
      $ref: '#/domainSuffix'
    name:
      $ref: '#/name'
    provider:
      $ref: '#/provider'
  required:
    - domainSuffix
    - name
    - provider
  type: object

Cluster:
  additionalProperties: false
  x-acl:
    admin:
      - read
      - update
    team:
      - read
  title: Cluster
  description: The k8s cluster managed by this Otomi instance.
  properties:
    apiName:
      $ref: '#/apiName'
      x-readOnly: true
    apiserver:
      $ref: '#/apiserver'
      x-readOnly: true
      description: Full url to a kubernetes api server. Used to generate kube context file.
      title: API Server
    domainSuffix:
      $ref: '#/domainSuffix'
      x-readOnly: true
    entrypoint:
      $ref: '#/entrypoint'
      x-readOnly: true
    k8sVersion:
      $ref: definitions.yaml#/k8sVersion
      x-readOnly: true
    name:
      $ref: '#/name'
      x-readOnly: true
    owner:
      $ref: '#/name'
      x-readOnly: true
    provider:
      $ref: '#/provider'
      x-readOnly: true
    region:
      $ref: '#/region'
      x-readOnly: true
    vpcID:
      $ref: '#/vpcID'
      x-readOnly: true
  required:
    - apiserver
    - domainSuffix
    - k8sVersion
    - name
    - provider
    - region
  type: object
