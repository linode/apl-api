adminPassword:
  type: string
  title: Admin password
  description: Uses `otomi.adminPassword` when left empty.
  x-secret: true
  x-acl:
    platformAdmin: [ read-any, update-any ]
    teamAdmin: [ ]
    teamMember: [ ]
alerts:
  additionalProperties: false
  type: object
  properties:
    repeatInterval:
      default: 3h
      description: Waiting time before sending a notification again after it was sent successfully for an alert.
      title: Repeat Interval
      type: string
    groupInterval:
      default: 5m
      description: Waiting time before sending a notification about new alerts that are added to a group of alerts.
      title: Group Interval
      type: string
    receivers:
      description: Select notification channel(s) for receiving alerts. Use 'none' if no channel available.
      title: Notification receivers
      type: array
      items:
        enum:
          - slack
          - msteams
          # - email
          - none
        type: string
      uniqueItems: true
    slack:
      title: Slack
      description: Configure Slack endpoints for alerts.
      additionalProperties: false
      properties:
        channel:
          default: mon-apl
          description: The Slack channel for non-critical notifications.
          title: Non-critical
          type: string
        channelCrit:
          default: mon-apl-crit
          description: The Slack channel for critical notifications.
          title: Critical
          type: string
        url:
          type: string
          description: A Slack webhook URL.
          x-acl:
            platformAdmin: [ read-any, update-any ]
            teamAdmin: [ ]
            teamMember: [ ]
          x-secret: true
      # TODO: Enable again when form rework is done
      # required:
      #   - url
      type: object
    msteams:
      additionalProperties: false
      description: Configure Microsoft Teams endpoints for alerts.
      properties:
        highPrio:
          title: High prio web hook
          type: string
          x-acl:
            platformAdmin: [ read-any, update-any ]
            teamAdmin: [ ]
            teamMember: [ ]
          x-secret: true
        lowPrio:
          title: Low prio web hook
          type: string
          x-acl:
            platformAdmin: [ read-any, update-any ]
            teamAdmin: [ ]
            teamMember: [ ]
          x-secret: true
      # TODO: Enable again when form rework is done
      # required:
      #   - highPrio
      #   - lowPrio
      title: Microsoft Teams
      type: object
    # NOTE: keep this in case email alertReceiver gets re-enabled again
    # email:
    #   title: Email
    #   description: Configure email endpoints for alerts.
    #   additionalProperties: false
    #   properties:
    #     critical:
    #       title: Critical Events
    #       $ref: '#/email'
    #       description: One or more email addresses (comma separated) for critical events.
    #     nonCritical:
    #       title: Non-critical Events
    #       $ref: '#/email'
    #       description: One or more email addresses (comma separated) for non-critical events.
    #   # TODO: Enable again when form rework is done
    #   # required:
    #   #   - critical
    #   #   - nonCritical
    #   type: object
annotation:
  type: string
  pattern: ^((.){1,253}\/)?(.){1,63}$
annotations:
  description: Kubernetes annotations with arbitrary metadata
  type: array
  items:
    type: object
    properties:
      name:
        $ref: '#/annotation'
      value:
        type: string
        maxLength: 32767
autoscaling:
  type: object
  properties:
    maxReplicas:
      type: integer
      default: 10
    minReplicas:
      type: integer
      default: 2
autoscalingNonEssential:
  type: object
  properties:
    maxReplicas:
      type: integer
      default: 5
    minReplicas:
      type: integer
      default: 1
autoscalingEnabled:
  type: object
  allOf:
    - properties:
        enabled:
          type: boolean
          default: true
    - $ref: '#/autoscaling'
autoscalingNonEssentialEnabled:
  type: object
  allOf:
    - properties:
        enabled:
          type: boolean
          default: true
    - $ref: '#/autoscalingNonEssential'
autoscalingTargets:
  type: object
  properties:
    targetCPUUtilizationPercentage:
      type: integer
      default: 80
    targetMemoryUtilizationPercentage:
      type: integer
      default: 80
agePrivateKey:
  title: Private key
  description: Age private key
  type: string
  x-secret: true
awsAccessKey:
  title: AWS access key
  description: An AWS access key ID.
  type: string
  x-secret: true
awsSecretKey:
  title: AWS secret key
  description: An AWS secret key.
  type: string
  x-secret: true
awsRegion:
  title: AWS region
  description: An AWS region.
  type: string
awsRole:
  description: Role may be set explicitly if no metadata can be accessed.
  example: arn:aws:iam::YYYYYYYYYYYY:role/dns-manager
  type: string
azureClientId:
  title: Azure client id
  description: An Azure client id.
  type: string
  x-secret: true
azureClientSecret:
  title: Azure client secret
  description: An Azure client secret.
  type: string
  x-secret: true
  x-acl:
    platformAdmin: [ read-any, update-any ]
    teamAdmin: [ ]
    teamMember: [ ]
azureDns:
  x-hideTitle: true
  properties:
    resourceGroup:
      $ref: '#/azureResourceGroup'
    hostedZoneName:
      title: Hosted zone name
      description: Name of the DNS zone that should be used.
      $ref: '#/wordCharacterPattern'
    tenantId:
      $ref: '#/azureTenantId'
    subscriptionId:
      $ref: '#/azureSubscriptionId'
    aadClientId:
      $ref: '#/azureClientId'
    aadClientSecret:
      $ref: '#/azureClientSecret'
      title: Client secret
      type: string
      description: Azure Application Client Secret
      x-acl:
        platformAdmin: [ read-any, update-any ]
        teamAdmin: [ ]
        teamMember: [ ]
      x-secret: true
  required:
    - tenantId
    - subscriptionId
    - resourceGroup
    - aadClientId
    - aadClientSecret
azureResourceGroup:
  title: Azure resource group
  description: An Azure resource group.
  type: string
azureSubscriptionId:
  title: Azure subscription id
  description: An Azure subscription id.
  type: string
azureTenantId:
  title: Azure tenant id
  description: An Azure tenant id. Defaults to one found in metadata.
  type: string
backupTtl:
  default: 168h
  description: Expiration of the backup. Defaults to 7 days.
  title: TTL after finished
  type: string
backupRetentionPolicy:
  default: 7d
  description: Delete backups according to retention policy. In DAYS|WEEKS|MONTHS
  title: Retention policy
  type: string
backupSchedule:
  default: 0 0 * * *
  description: Cron-type expression to schedule the backup. Defaults to once a day at 00:00.
  type: string
clusterName:
  $ref: '#/idName'
  description: Name of the cluster.
  type: string
containerSpecNoSec:
  properties:
    image:
      $ref: '#/image'
    resources:
      $ref: '#/resources'
      title: Container resources
    env:
      $ref: '#/env'
    secrets:
      $ref: '#/secrets'
    secretMounts:
      $ref: '#/secretMounts'
    files:
      $ref: '#/files'
    command:
      type: string
      title: Command
      description: Override the entrypoint/command of the container.
    args:
      type: string
      title: Command arguments
      description: Override the arguments given to the entrypoint/command of the container.
  required:
    - image
    - resources
  type: object
containerSpec:
  allOf:
    - properties:
        securityContext:
          $ref: '#/securityContext'
    - $ref: '#/containerSpecNoSec'
  type: object
dns:
  title: DNS
  type: object
  description: Domain name server settings.
  additionalProperties: false
  properties:
    zones:
      description: Extra DNS zones the cluster can administer (see DNS). Teams can use this domain for Service exposure.
      items:
        type: string
        title: Zone
      title: Zones
      type: array
      uniqueItems: true
    domainFilters:
      description: Limit possible target zones by domain suffixes.
      items:
        type: string
      type: array
    zoneIdFilters:
      description: Limit possible target zones by zone id.
      items:
        type: string
      type: array
    provider:
      description: The DNS provider managing the domains.
      title: Provider
      oneOf:
        - $ref: '#/offChoice'
        - title: Akamai
          properties:
            akamai:
              x-hideTitle: true
              properties:
                host:
                  title: Akamai API host
                  description: Akamai Edgegrid API server
                  type: string
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                accessToken:
                  title: Akamai access token
                  description: Akamai Edgegrid API access token
                  type: string
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
                clientToken:
                  title: Akamai client token
                  description: Akamai Edgegrid API client token
                  type: string
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
                clientSecret:
                  title: Akamai client secret
                  description: Akamai Edgegrid API client secret
                  type: string
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
              required:
                - host
                - accessToken
                - clientToken
                - clientSecret
              type: object
        - title: AWS
          properties:
            aws:
              x-hideTitle: true
              properties:
                credentials:
                  properties:
                    secretKey:
                      $ref: '#/awsSecretKey'
                    accessKey:
                      $ref: '#/awsAccessKey'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  type: object
                region:
                  $ref: '#/awsRegion'
                role:
                  $ref: '#/awsRole'
              required: [ region ]
              type: object
          required:
            - aws
          type: object
        - title: Azure
          properties:
            azure:
              $ref: '#/azureDns'
          required:
            - azure
          type: object
        - title: Azure Private DNS
          properties:
            azure-private-dns:
              $ref: '#/azureDns'
          required:
            - azure-private-dns
          type: object
        - title: CloudFlare
          properties:
            cloudflare:
              x-hideTitle: true
              properties:
                apiToken:
                  type: string
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
                apiSecret:
                  type: string
                  description: Required when Email is set.
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
                email:
                  $ref: '#/email'
                  description: Required when ApiSecret is set.
                proxied:
                  type: boolean
                  default: true
              type: object
          required:
            - cloudflare
          type: object
        - title: Digital Ocean
          properties:
            digitalocean:
              x-hideTitle: true
              properties:
                apiToken:
                  type: string
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
              type: object
          required:
            - digitalocean
          type: object
        - title: Linode
          properties:
            linode:
              x-hideTitle: true
              properties:
                apiToken:
                  type: string
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
              type: object
          required:
            - linode
          type: object
        - title: Google
          properties:
            google:
              x-hideTitle: true
              properties:
                serviceAccountKey:
                  $ref: '#/googleAccountJson'
                  description: A service account key in json format for managing a DNS zone.
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                    x-secret: true
                project:
                  $ref: '#/googleProject'
              required: [ project ]
              type: object
          required:
            - google
          type: object
        - title: Other
          properties:
            other:
              description: This option requires configuration for both external-dns as well as cert-manager. No schema validation is available so provide correct data.
              type: object
              properties:
                name:
                  type: string
                  description: Name of the provider.
                external-dns:
                  title: YAML for external-dns.
                  type: object
                  description: 'The provider config'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
                cert-manager:
                  title: YAML for cert-manager.
                  type: object
                  description: 'The dns01 config as provided here: https://cert-manager.io/docs/configuration/acme/dns01/'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                  x-secret: true
              required:
                - name
                - external-dns
                - cert-manager
          required:
            - other
domain:
  pattern: ^((([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9]))|([a-f0-9:]+:+)+[a-f0-9]+$
  x-message: a valid fully qualified domain name (FQDN)
  type: string
domainSuffix:
  $ref: '#/domain'
  title: Domain suffix
  description: The domain suffix for the cluster.
droneGit:
  properties:
    clientID:
      $ref: '#/wordCharacterPattern'
    clientSecretValue:
      type: string
      x-acl:
        platformAdmin: [ read-any, update-any ]
        teamAdmin: [ ]
        teamMember: [ ]
      x-secret: true
  type: object
  required: [ clientID, clientSecretValue ]
duration:
  description: 'Prometheus duration (See: https://prometheus.io/docs/prometheus/latest/configuration/configuration/#configuration-file)'
  pattern: '((([0-9]+)y)?(([0-9]+)w)?(([0-9]+)d)?(([0-9]+)h)?(([0-9]+)m)?(([0-9]+)s)?(([0-9]+)ms)?|0)'
  type: string
  default: 1d
email:
  pattern: ^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$
  x-message: a valid email address
  type: string
env:
  title: Environment variables
  description: Environment variables for containers.
  type: array
  nullable: true
  items:
    properties:
      name:
        type: string
        pattern: ^[a-zA-Z0-9_]*$
        x-message: a valid environment variable name that consists of letters and underscores
      value:
        type: string
        maxLength: 131072
    required:
      - name
      - value
    type: object
endpoints:
  title: Endpoints
  type: array
  nullable: true
  items:
    properties:
      port:
        $ref: '#/portNumber'
      path:
        type: string
    required:
      - port
      - path
    type: object
files:
  description: 'Entries of absolute path > content pairs. One caveat: content can be 131072 chars max.'
  title: Files
  type: array
  nullable: true
  items:
    properties:
      path:
        type: string
        pattern: ^\/[^\0]+$
        x-message: a valid file name
      content:
        type: string
        maxLength: 131072
    required:
      - path
      - content
    type: object
googleAccountJson:
  description: Enter GCP account JSON for authentication.
  title: Account JSON
  type: string
  x-secret: true
  x-formtype: textarea
googleProject:
  description: Enter GCP project.
  title: GCP Project
  type: string
hostPort:
  pattern: ^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9]):()([1-9]|[1-5]?[0-9]{2,4}|6[1-4][0-9]{3}|65[1-4][0-9]{2}|655[1-2][0-9]|6553[1-5])$
  type: string
  x-message: a valid host port
k8sName:
  pattern: ^[a-z]([_-a-z0-9]*[a-z0-9])+$
  type: string
  x-message: a valid name that consists of lowercase letters, dashes, underscores
idName:
  pattern: ^[a-z]([-a-z0-9]*[a-z0-9])+$
  type: string
  x-message: a valid name that consists of lowercase letters, dashes
image:
  allOf:
    - properties:
        repository:
          description: A container image repository.
          pattern: ^[a-z0-9]+(?:[/._-]{1,2}[a-z0-9]+)*$
          x-message: a valid container registry repository
          type: string
      required:
        - repository
      type: object
    - $ref: '#/imageSimple'
  title: Container image
  description: Anything specified here overrides image specs from the release
imagePullPolicy:
  description: Container pull policy.
  default: IfNotPresent
  enum:
    - IfNotPresent
    - Always
  type: string
imageRegistry:
  pattern: ^[a-z0-9]+(?:[/._-]{1,2}[a-z0-9]+)*$
  type: string
  title: registry
imageTag:
  pattern: '[\w][\w.-]{0,127}'
  type: string
  x-message: a valid container registry image tag
imageSimple:
  properties:
    tag:
      $ref: '#/imageTag'
    pullPolicy:
      $ref: '#/imagePullPolicy'
  required:
    - tag
  type: object
  title: Container image
ingressClassParameters:
  type: object
  properties:
    loadBalancerIP:
      title: Load balancer IP address
      description: 'Optional: A static IP address assigned to a load balancer.'
      type: string
    # sourceIpAddressFiltering:
    #   title: Source IP address filtering
    #   type: string
    #   description: 'Whitelist source IP address ranges. The value is a comma separated list of CIDRs, e.g. 10.0.0.0/24,172.10.0.1'
    entrypoint:
      $ref: '#/ipV4Address'
      description: 'Optional: An IP address that will be used for DNS records.'
    annotations:
      additionalProperties: false
      title: Annotations
      description: Annotations for the Load Balancer service resource.
      type: array
      items:
        type: object
        properties:
          key:
            title: Key
            type: string
          value:
            title: Value
            type: string
ipV4Address:
  type: string
  pattern: ^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$
kms:
  additionalProperties: false
  description: Manage settings for retrieving encryption/decryption keys.
  title: Platform Secrets Engine settings
  type: object
  properties:
    sops:
      description: Select encryption engine for SOPS to encrypt the platform secrets.
      title: SOPS configuration
      type: object
      oneOf:
        - $ref: '#/offChoice'
        - properties:
            provider:
              type: string
              enum:
                - age
              default: age
            age:
              type: object
              properties:
                publicKey:
                  title: Public key
                  description: Age public key
                  type: string
                privateKey:
                  $ref: '#/agePrivateKey'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
              required:
                - publicKey
                - privateKey
              title: Age configuration
          required:
            - age
          title: Age
          type: object
        - properties:
            provider:
              type: string
              enum:
                - aws
              default: aws
            aws:
              type: object
              properties:
                keys:
                  description: Comma separated list of one or two ARNs to keys as defined in AWS KMS. One if used for both enc+dec. Two if one for enc, other for dec.
                  title: AWS KMS keys
                  type: string
                accessKey:
                  $ref: '#/awsAccessKey'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                secretKey:
                  $ref: '#/awsSecretKey'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                region:
                  $ref: '#/awsRegion'
              required:
                - accessKey
                - keys
                - secretKey
              title: AWS configuration
          required:
            - aws
          title: AWS KMS
          type: object
        - properties:
            provider:
              type: string
              default: azure
              enum:
                - azure
            azure:
              type: object
              properties:
                keys:
                  description: Comma separated list of one or two paths to keys as defined in Azure Keyvault. One if used for both enc+dec. Two if one for enc, other for dec.
                  title: Azure Keyvault keys
                  type: string
                clientId:
                  $ref: '#/azureClientId'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                clientSecret:
                  $ref: '#/azureClientSecret'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                tenantId:
                  $ref: '#/azureTenantId'
              required:
                - clientId
                - clientSecret
                - keys
              title: Azure configuration
          required:
            - azure
          title: Azure Keyvault
          type: object
        - properties:
            provider:
              type: string
              default: google
              enum:
                - google
            google:
              type: object
              properties:
                keys:
                  description: Comma separated list of one or two paths to keys as defined in GCP KMS. One if used for both enc+dec. Two if one for enc, other for dec.
                  title: GCP KMS keys
                  type: string
                accountJson:
                  $ref: '#/googleAccountJson'
                  x-acl:
                    platformAdmin: [ read-any, update-any ]
                    teamAdmin: [ ]
                    teamMember: [ ]
                project:
                  $ref: '#/googleProject'
              required:
                - keys
                - accountJson
                - project
              title: GCP configuration
          required:
            - google
          title: Google KMS
          type: object
labels:
  $ref: '#/annotations'
  description: A set of labels.
logLevel:
  title: Log Level
  type: string
  default: info
  enum:
    - error
    - warn
    - info
    - debug
    - trace
offChoice:
  additionalProperties: false
  nullable: true
  title: 'None'
  type: object
otomiAdminUsername:
  type: string
  x-secret: '"admin"'
path:
  description: An absolute path
  type: string
  pattern: '^[/].*$'
podSecurityContext:
  properties:
    runAsUser:
      $ref: '#/runAsUser'
    runAsGroup:
      $ref: '#/runAsGroup'
    runAsNonRoot:
      $ref: '#/runAsNonRoot'
    fsGroup:
      description: Supplementary group ID. Volumes that support ownership management are modified to be owned and writable by this ID.
      type: string
    fsGroupChangePolicy:
      description:
        'Defines behavior for changing ownership and permission of the volume before being exposed inside a Pod. This field only applies to volume types that support fsGroup controlled ownership and permissions.
        This field has two possible values:
        OnRootMismatch: Only change permissions and ownership if permission and ownership of root directory does not match with expected permissions of the volume. This could help shorten the time it takes to change ownership and permission of a volume.
        Always: Always change permission and ownership of the volume when volume is mounted.'
      enum:
        - Always
        - OnRootMismatch
      type: string
  description: Security context for the pod.
  title: Pod security context
  type: object
podSpec:
  allOf:
    - properties:
        annotations:
          $ref: '#/annotations'
          title: Pod annotations
      type: object
    - properties:
        podSecurityContext:
          $ref: '#/podSecurityContext'
      type: object
    - $ref: '#/containerSpec'
  type: object
portNumber:
  maximum: 32768
  minimum: 80
  type: integer
provider:
  title: Provider
  description: The cloud provider of this cluster.
  type: string
  enum:
    - linode
    - custom
priority:
  title: Minimum priority
  description: Minimum priority of alert events.
  type: string
  default: informational
  enum:
    - emergency
    - alert
    - critical
    - error
    - warning
    - notice
    - informational
    - debug
quantityCpu:
  title: CPU quantity
  description: Amount of cores, or slice of CPU in millis.
  example: 50m
  pattern: (^[1-9][0-9]*(?!<.*)$)|(^([0]|[1-9]+)\.[0-9]{1,3}(?!<.*)$)|(^[1-9][0-9]*m$)
  type: string
quantityMem:
  title: Memory quantity
  description: Amount of memory. Valid units are E|P|T|G|M|K|Ei|Pi|Ti|Gi|Mi|Ki.
  example: 1Gi
  pattern: ^([0-9]+\.)?[0-9]+(E|P|T|G|M|K|Ei|Pi|Ti|Gi|Mi|Ki)$
  type: string
rawValues:
  description: 'May define value overrides for a chart. WARNING: these values currently have no schema and will not be validated.'
  type: object
  x-acl:
    platformAdmin: [ read-any, update-any ]
    teamAdmin: [ ]
    teamMember: [ ]
replicas:
  type: integer
  title: Number of replicas
  default: 1
repoUrl:
  description: Path to a remote git repo without protocol. Will use https to access.
  pattern: ^(.+@)*([\w\d\.]+)(:[\d]+){0,1}/*(.*)$
  type: string
  x-message: a valid git repo URL
resource:
  properties:
    cpu:
      $ref: '#/quantityCpu'
    memory:
      $ref: '#/quantityMem'
  required:
    - cpu
    - memory
  type: object
resources:
  description: Compute resources for containers.
  properties:
    limits:
      $ref: '#/resource'
      description: Requested resources (best effort).
    requests:
      $ref: '#/resource'
      description: Requested resources (guaranteed).
  required:
    - limits
    - requests
  type: object
resourceQuota:
  title: Resource Quota
  description: >
    Kubernetes resource quota. Should adhere to the format described at:
    https://kubernetes.io/docs/concepts/policy/resource-quotas/.
  type: object
  properties:
    enabled:
      type: boolean
      title: Enabled
      default: true
      description: Whether resource quotas are enabled.
    countQuota:
      type: array
      title: Count Quota
      items:
        type: object
        properties:
          key:
            type: string
            title: Key
          value:
            type: number
            title: Value
          mutable:
            type: boolean
            title: Mutable
          decorator:
            type: string
            title: Decorator
        required:
          - key
          - value
          - mutable
          - decorator
      default:
        - key: 'loadbalancers'
          value: 0
          mutable: false
          decorator: 'lbs'
        - key: 'nodeports'
          value: 0
          mutable: false
          decorator: 'nprts'
        - key: 'count'
          value: 5
          mutable: true
          decorator: 'pods'
    computeResourceQuota:
      type: array
      title: Compute Resource Quota
      items:
        type: object
        properties:
          key:
            type: string
            title: Key
          value:
            type: number
            title: Value
          decorator:
            type: string
            title: Decorator
        required:
          - key
          - value
          - decorator
      default:
        - key: 'limits.cpu'
          value: 500
          decorator: 'mCPUs'
        - key: 'requests.cpu'
          value: 250
          decorator: 'mCPUs'
        - key: 'limits.memory'
          value: 500
          decorator: 'Mi'
        - key: 'requests.memory'
          value: 500
          decorator: 'Mi'
    customQuota:
      type: array
      title: Custom Quota
      items:
        type: object
        properties:
          key:
            type: string
            title: Key
          value:
            type: number
            title: Value
        required:
          - key
          - value
      default: []
  required:
    - enabled
    - countQuota
    - computeResourceQuota

runAsNonRoot:
  description: Will prevent the container from starting with UID 0.
  title: Run as non-root
  type: boolean
  default: true
runAsUser:
  description: The UID to run the entrypoint of the container process.
  default: 1001
  maximum: 65535
  minimum: 0
  title: Run as user
  type: integer
runAsGroup:
  description: The GID to run the entrypoint of the container process.
  default: 1001
  maximum: 65535
  minimum: 0
  title: Run as group
  type: integer
scaling:
  description: Min and max number of replicas.
  properties:
    minReplicas:
      type: integer
      title: Minimum number of replicas
    maxReplicas:
      type: integer
      title: Maximum number of replicas
  type: object
script:
  description: May specify a non-empty string containing an executable script.
  type: string
securityContext:
  additionalProperties:
    uniqueItems: true
  properties:
    runAsUser:
      $ref: '#/runAsUser'
    runAsGroup:
      $ref: '#/runAsGroup'
    runAsNonRoot:
      $ref: '#/runAsNonRoot'
  type: object
secrets:
  description: A list of Team secrets that will be mounted into the pod as environment variables.
  items:
    type: string
  title: Secrets
  type: array
  uniqueItems: true
args:
  title: Command arguments
  description: Override the arguments given to the entrypoint/command of the container.
  items:
    type: string
  type: array
servicePorts:
  title: Service Ports
  type: array
  nullable: true
  items:
    properties:
      name:
        type: string
      port:
        $ref: '#/portNumber'
      targetPort:
        type: string
      protocol:
        type: string
        enum:
          - TCP
          - UDP
        default: TCP
    required:
      - name
      - port
      - targetPort
      - protocol
    type: object
secretMounts:
  description: Pairs of secret name > absolute folder path. Will mount the contents of the secret in the container at the specified folder path.
  title: Secret mounts
  type: array
  items:
    properties:
      name:
        $ref: '#/idName'
      path:
        $ref: '#/path'
    type: object
    required: [ name, path ]
s3Url:
  type: string
  description: An url to an AWS S3 bucket.
size:
  description: Disk size. Valid units are E|P|T|G|Ti|Gi.
  pattern: '^([0-9]+\.)?[0-9]+(E|P|T|G||Ti|Gi)?$'
  type: string
svcPredeployed:
  description: Will map onto a predeployed k8s service.
  properties:
    serviceType:
      default: svcPredeployed
      enum:
        - svcPredeployed
      type: string
  title: Existing Kubernetes service
  type: object
url:
  pattern: ^https?:\/\/[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&\/=]*)
  type: string
vaultToken:
  title: Token
  type: string
  x-secret: true
volumes:
  items:
    additionalProperties: false
    properties:
      configMap:
        properties:
          name:
            $ref: 'definitions.yaml#/idName'
        type: object
      name:
        description: Name must match mount name.
        $ref: 'definitions.yaml#/idName'
    type: object
  type: array
wordCharacterPattern:
  type: string
  pattern: ^[^\s]+$
  x-error: At least one non whitespace character
