Netpol:
  x-acl:
    platformAdmin:
      - create-any
      - read-any
      - update-any
      - delete-any
    teamAdmin:
      - create-any
      - read-any
      - update-any
      - delete-any
    teamMember:
      - create
      - read
      - update
      - delete
  type: object
  x-externalDocsPath: docs/for-devs/console/netpols
  properties:
    id:
      type: string
    teamId:
      $ref: 'definitions.yaml#/idName'
    name:
      title: The name of the network policy.
      $ref: 'definitions.yaml#/wordCharacterPattern'
    ruleType:
      $ref: '#/ruleType'
  required:
    - name

ruleType:
  title: Rule type
  description: Choose between Ingress or Egress.
  type: object
  properties:
    type:
      type: string
      enum:
        - ingress
        - egress
      default: ingress
    ingress:
      additionalProperties: false
      type: object
      properties:
        toLabelName:
          type: string
          title: Selector label name
          description: 'The name of the Pod selector label.'
        toLabelValue:
          type: string
          title: Selector label value
          description: 'The value of the Pod selector label.'
        mode:
          type: string
          default: AllowAll
          enum:
            - AllowAll
            - AllowOnly
        allow:
          title: Allow an entire Team or specific Workloads.
          type: array
          minItems: 1
          items:
            type: object
            properties:
              fromNamespace:
                type: string
                title: Namespace name
                description: 'The name of the namespace.'
              fromLabelName:
                type: string
                title: Selector label name
                description: 'The name of the Pod selector label.'
              fromLabelValue:
                type: string
                title: Selector label value
                description: 'The value of the Pod selector label.'
            required:
              - fromNamespace
      required:
        - mode
    egress:
      additionalProperties: false
      type: object
      properties:
        domain:
          title: FQDN or IP address
          $ref: definitions.yaml#/domain
        ports:
          type: array
          items:
            type: object
            properties:
              number:
                title: Port number
                type: integer
                minimum: 1
                maximum: 65535
              protocol:
                title: Protocol
                type: string
                enum: [HTTPS, HTTP, TCP]
                default: HTTPS
            required:
              - number
              - protocol
          default:
            - number: 443
              protocol: HTTPS
      required:
        - domain
