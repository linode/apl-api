policies:
  description: |
    List of policy objects used by Open Policy Agent tools (Conftest, Gatekeeper) to run policy based validation against both in-cluster Kubernetes contexts and plain Yaml resources
  additionalProperties: false
  properties:
    banned-image-tags:
      additionalProperties: false
      required: [enabled]
      properties:
        tags:
          type: array
          items:
            type: string
        enabled:
          type: boolean
          default: false
    container-limits:
      additionalProperties: false
      required: [enabled]
      properties:
        cpu:
          $ref: definitions.yaml#/cpuQuantity
        memory:
          $ref: definitions.yaml#/memoryQuantity
        enabled:
          type: boolean
          default: false
    psp-allowed-repos:
      additionalProperties: false
      required: [enabled]
      properties:
        repos:
          type: array
          items:
            type: string
        enabled:
          type: boolean
          default: false
    psp-host-filesystem:
      additionalProperties: false
      required: [enabled]
      properties:
        allowedHostPaths:
          type: array
          items:
            type: object
            required: [pathPrefix, readOnly]
            properties:
              pathPrefix:
                type: string
              readOnly:
                type: boolean
            additionalProperties: false
        enabled:
          type: boolean
          default: false
    psp-allowed-users:
      additionalProperties: false
      required: [enabled]
      properties:
        runAsUser:
          type: object
          additionalProperties: false
          required: [rule]
          properties:
            rule:
              type: string
              enum: [RunAsAny, MustRunAsNonRoot, MustRunAs]
            ranges:
              type: array
              items:
                type: object
                additionalProperties: false
                required: [min, max]
                properties:
                  min:
                    type: integer
                  max:
                    type: integer
        runAsGroup:
          type: object
          properties:
            rule:
              type: string
              enum: [RunAsAny, MayRunAs, MustRunAs]
            ranges:
              type: array
              items:
                type: object
                additionalProperties: false
                required: [min, max]
                properties:
                  min:
                    type: integer
                  max:
                    type: integer
        supplementalGroups:
          type: object
          properties:
            rule:
              type: string
              enum: [RunAsAny, MayRunAs, MustRunAs]
            ranges:
              type: array
              items:
                type: object
                additionalProperties: false
                required: [min, max]
                properties:
                  min:
                    type: integer
                  max:
                    type: integer
        fsGroup:
          type: object
          properties:
            rule:
              type: string
              enum: [RunAsAny, MayRunAs, MustRunAs]
            ranges:
              type: array
              items:
                type: object
                additionalProperties: false
                required: [min, max]
                properties:
                  min:
                    type: integer
                  max:
                    type: integer
        enabled:
          type: boolean
          default: false
    psp-host-security:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
    psp-host-networking-ports:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
    psp-privileged:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
    psp-capabilities:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
        allowedCapabilities:
          type: array
          items:
            type: string
        requiredDropCapabilities:
          type: array
          items:
            type: string
    psp-forbidden-sysctls:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
        forbiddenSysctls:
          type: array
          items:
            type: string
    psp-apparmor:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
        allowedProfiles:
          type: array
          items:
            type: string
    psp-seccomp:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
        allowedProfiles:
          type: array
          items:
            type: string
    psp-selinux:
      additionalProperties: false
      required: [enabled]
      properties:
        enabled:
          type: boolean
          default: false
        seLinuxContext:
          type: string
          enum: [MustRunAs, RunAsAny]
        allowedSELinuxOptions:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              level:
                type: string
              role:
                type: string
              type:
                type: string
              user:
                type: string
