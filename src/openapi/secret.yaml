shared:
  x-acl:
    admin: [read-any, create-any, update-any, delete-any]
    team: [read, create, update, delete]
  properties:
    id:
      readOnly: true
      type: string
    name:
      type: string
      pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$'
      title: Name
      description: A secret name
      example: secret01
    clusterId:
      x-acl:
        admin: [read, create]
        team: [read, create]
      title: Cluster ID
      type: string
      description: A kubernetes cluster for the secret
    type:
      default: generic
      enum:
        - generic
        - docker-registry
        - tls
      type: string
  required:
    - name
    - clusterId
  type: object

SecretGeneric:
  $ref: '#/shared'
  properties:
    entries:
      type: array
      items:
        description: A property name at vaultPath
        minItems: 1
        pattern: '^[a-zA-Z0-9_]*$'
        type: string
        uniqueItems: true
    type:
      type: string
      default: generic
      readOnly: true
  required:
    - type
    - entries
  type: object

SecretDocker:
  $ref: '#/shared'
  properties:
    dockerconfig:
      type: string
      default: '.dockerconfig.json'
      readOnly: true
    type:
      type: string
      default: docker-registry
      readOnly: true
  required:
    - type
  type: object

SecretTLS:
  $ref: '#/shared'
  properties:
    crt:
      type: string
      default: 'tls.crt'
      description: A Vault property name that contains PEM public key certificate
    key:
      type: string
      default: 'tls.key'
      description: A Vault property name that contains PEM private key certificate
    ca:
      type: string
      title: CA
      description: A Vault property name that contains CA certificate content
    type:
      type: string
      default: tls
      readOnly: true
  required:
    - type
    - crt
    - key
  type: object

Secret:
  discriminator:
    propertyName: type
    mapping:
      docker-registry: '#/SecretDocker'
      generic: '#/SecretGeneric'
      tls: '#/SecretTLS'
  oneOf:
    - title: Generic
      $ref: '#/SecretGeneric'
    - title: Docker registry
      $ref: '#/SecretDocker'
    - title: TLS
      $ref: '#/SecretDocker'
