idName: &idNameField
  type: string
  pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
dockerRegistry: &dockerRegistry
  type: string
  pattern: ^[a-z0-9]+(?:[._-][a-z0-9]+)*$

Secret:
  x-acl:
    admin: [read-any, create-any, update-any, delete-any]
    team: [read, create, update, delete]
  type: object
  properties:
    id:
      type: string
      readOnly: true
    name:
      <<: *idNameField
      title: Name
      description: A secret name
      example: secret01
      x-acl:
        admin: [read, update, create]
        team: [create]
    type:
      type: string
      default: docker-registry
      x-acl:
        admin: [read, update, create]
        team: [create]
  oneOf:
    - title: Docker Registry
      properties:
        type:
          type: string
          enum: [docker-registry]
          default: docker-registry
        server:
          type: string
          <<: *dockerRegistry
        username:
          type: string
        password:
          type: string
          # writeOnly: true
      required: [server, username, password]
    - title: Generic
      properties:
        type:
          type: string
          enum: [generic]
          default: generic
        entries:
          type: array
          description: Key names and their values
          items:
            type: object
            properties:
              key:
                description: Key or file name
                example: secretstuff.conf
                type: string
              value:
                description: Value to be encrypted
                example: password=yoursecretpassword
                type: string
                # writeOnly: true
            required: [key, value]
      required: [entries]
    - title: TLS
      properties:
        type:
          type: string
          enum: [tls]
          default: tls
        crt:
          description: The PEM encoded public key certificate content
          type: string
        key:
          description: The private key certificate content
          type: string
        ca:
          description: The CA certificate content
          type: string
      required: [crt, key]
  required:
    - name
    - type
