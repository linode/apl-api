SecretBase: &secretBase
  id:
    readOnly: true
    type: string
  name:
    type: string
    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
    title: Name
    description: A secret name
    example: secret01

Secret:
  x-acl:
    admin: [read-any, create-any, update-any, delete-any]
    team: [read, create, update, delete]
  # additionalProperties: false
  properties:
    id:
      readOnly: true
      type: string
    name:
      type: string
      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
      title: Name
      description: A secret name
      example: secret01
    secret:
      title: Type
      description: Type of secret used in Otomi.
      oneOf:
        - $ref: '#/SecretGeneric'
        - $ref: '#/SecretDockerRegistry'
        - $ref: '#/SecretTLS'
      type: object
  required:
    - name
    - secret

SecretGeneric:
  title: Generic
  properties:
    type:
      type: string
      enum:
        - generic
      default: generic
    entries:
      type: array
      items:
        description: A property name at a vault path
        pattern: '^[a-zA-Z0-9_]*$'
        type: string
      uniqueItems: true
      minItems: 1
  type: object
  required:
    - type
    - entries

SecretDockerRegistry:
  title: Docker registry
  properties:
    type:
      type: string
      enum:
        - docker-registry
      default: docker-registry
  type: object
  required:
    - type

SecretTLS:
  title: TLS
  properties:
    type:
      type: string
      enum:
        - tls
      default: tls
    crt:
      type: string
      default: 'tls.crt'
    key:
      type: string
      default: 'tls.key'
    ca:
      type: string
      default: 'ca.crt'
  type: object
  required:
    - type
    - crt
