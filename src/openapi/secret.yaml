Secret:
  x-acl:
    admin: [read-any, create-any, update-any, delete-any]
    team: [read, create, update, delete]
  # additionalProperties: false
  properties:
    id:
      # readOnly: true
      type: string
    name:
      type: string
      # A lowercase RFC 1123 subdomain must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character (e.g. 'example.com')
      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
      description: A secret name
    namespace:
      $ref: definitions.yaml#/idName
      description: A kubernetes namespace.
      x-acl:
        admin: [read-any, create-any, update-any, delete-any]
        team: []
    secret:
      title: Type
      description: Type of secret used in APL.
      oneOf:
        - $ref: '#/SecretGeneric'
        - $ref: '#/SecretDockerRegistry'
        - $ref: '#/SecretTLS'
      type: object
  required:
    - name
    - secret
  type: object
  x-externalDocsPath: docs/for-devs/console/secrets

SecretGeneric:
  title: Generic
  description: The secret's entries listed here must exist in the corresponding vault secret.
  properties:
    type:
      type: string
      enum:
        - generic
      default: generic
    entries:
      type: array
      items:
        description: A property in a vault secret.
        # a valid k8s secret key must consist of alphanumeric characters, '-', '_' or '.' (e.g. 'key.name',  or 'KEY_NAME',  or 'key-name'
        pattern: ^[-._a-zA-Z0-9]+$
        type: string
      uniqueItems: true
      minItems: 1
  type: object
  required:
    - type
    - entries

SecretDockerRegistry:
  title: Docker registry
  description: A secret in vault with one property ".dockerconfigjson" that is an encoded dockerconfigjson blob.
  properties:
    type:
      type: string
      enum:
        - docker-registry
      default: docker-registry
  type: object
  required:
    - type

SecretTLS:
  title: TLS
  description: The TLS fields must exist in the corresponding vault secret.
  properties:
    type:
      type: string
      enum:
        - tls
      default: tls
    crt:
      type: string
      default: tls.crt
    key:
      type: string
      default: tls.key
    ca:
      type: string
      default: ca.crt
  type: object
  required:
    - type
    - crt
