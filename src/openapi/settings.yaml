Settings:
  x-acl:
    admin: [read-any, update-any]
    team: []
  additionalProperties: false
  properties:
    alerts:
      $ref: definitions.yaml#/alerts
      title: Alerts
      description: Configure alerting endpoints to receive notifications from Alertmanager and Otomi deployments.
      x-externalDocsPath: docs/console/settings/alerts
    home:
      $ref: definitions.yaml#/alerts
      title: Home alerts
      description: Same setup as 'Alerts', but to send copies of alerts "home". Useful for co-monitoring managed clusters of customers.
      x-externalDocsPath: docs/console/settings/home
    azure:
      title: Azure
      additionalProperties: false
      description: Azure specific configuration. Only applicable on Azure clusters.
      properties:
        appgw:
          properties:
            isManaged:
              default: true
              title: Managed by AKS
              description:
                In case `otomi.hasCloudLB` is set, this setting indicates that an Azure AppGW Ingress Controller was already installed by AKS as an addon (only available on "Preview" clusters).
                Turning this off will let Otomi install an AppGW controller.
              type: boolean
          type: object
        monitor:
          $ref: definitions.yaml#/azureMonitor
        storageType:
          title: Storage types
          description: Disk types used for storage classes in Otomi.
          properties:
            fast:
              type: string
              default: StandardSSD_LRS
            standard:
              type: string
              default: StandardLRS
          type: object
      required:
        - resourceGroup
        - subscriptionId
        - tenantId
      type: object
    cluster:
      $ref: cluster.yaml#/Cluster
    dns:
      $ref: definitions.yaml#/dns
      x-externalDocsPath: docs/console/settings/dns
    kms:
      $ref: definitions.yaml#/kms
      x-externalDocsPath: docs/console/settings/kms
    oidc:
      title: OIDC
      description: OpenID Connect settings.
      additionalProperties: false
      properties:
        issuer:
          title: Issuer
          type: string
          $ref: definitions.yaml#/url
        clientID:
          title: Client ID
          type: string
        clientSecret:
          title: Client Secret
          type: string
        adminGroupID:
          title: Admin group ID
          type: string
        teamAdminGroupID:
          title: Team admin group ID
          type: string
        usernameClaimMapper:
          description: Claim name used by Keycloak to identify incoming users from the identity provider.
          x-default: '${CLAIM.upn}'
          title: Username claim mapper
          type: string
        subClaimMapper:
          type: string
          title: Sub claim mapper
          description: Select OIDC claim to be passed by Keycloak as a unique user identifier. Best to not change this from the default.
          x-default: sub
      type: object
      x-externalDocsPath: docs/console/settings/oidc
    otomi:
      title: Otomi
      type: object
      description: Settings for Otomi.
      additionalProperties: false
      properties:
        adminPassword:
          type: string
          title: Admin password
          description: Otomi global admin password. Will be used as default for all apps that are not provide with a password. Easy for access and quick to rotate.
        additionalClusters:
          title: Additional clusters
          description: Enter other k8s clusters, if there are any.
          type: array
          items:
            $ref: cluster.yaml#/AdditionalCluster
            required:
              - domainSuffix
              - name
              - provider
        globalPullSecret:
          title: Global pullsecret
          description: Will be connected to each "default" service account in all otomi app namespaces.
            Handy for authenticating with DockerHub to avoid rate limiting.
            Also useful when pulling all otomi images from a private repo. (One would need to override all the images in the config first.)
          additionalProperties: false
          properties:
            username:
              type: string
            password:
              type: string
              x-secret: ''
            email:
              type: string
              x-default: not@us.ed
            server:
              type: string
              x-default: docker.io
          required:
            - username
            - password
          type: object
        hasCloudLB:
          default: false
          description: Set this to true when an external load balancer exists (Azure AppGW, Google Apigee) or needs to be started (AWS ALB). This will then be configured through ingress controllers. Expects existing LBs to terminate https. Currently this is only working correctly for Azure, and not for AWS and Google. AWS is close to completion.
          title: External load balancer
          type: boolean
        hasExternalDNS:
          description: Set this to true when an external dns zone is available to manage dns records. (Expects required `dns:` fields to be set.)
          default: true
          title: External DNS
          type: boolean
        hasExternalIDP:
          default: false
          description: Set this to true when bringing your own external IDP such as Azure AD. (Expects required `oidc:` fields to be set.)
          title: External IDP
          type: boolean
        isHomeMonitored:
          default: false
          description: Whether this cluster is home monitored (like when under a Premium SLA). Sends criticals home.
          title: Home monitored
          type: boolean
        isManaged:
          default: true
          description: Whether masters are managed and not under control. Set this to false when onprem.
          title: Managed masters
          type: boolean
        isMultitenant:
          default: true
          description: Will separate team metrics and logs. Disabling this lets everybody be admin and see everything.
          title: Multi-tenancy
          type: boolean
        version:
          title: Otomi version
          default: latest
          description: |
            Please pin this to a valid release version found in the repo. Suggestion: try the most recent stable version.
          type: string
      x-externalDocsPath: docs/console/settings/otomi
    policies:
      $ref: policies.yaml#/policies
    smtp:
      title: SMTP
      description: Mail server settings.
      additionalProperties: false
      nullable: true
      properties:
        auth_identity:
          title: Authentication identity
          type: string
        auth_password:
          title: Authentication password
          type: string
        auth_secret:
          title: Authentication secret
          type: string
        auth_username:
          title: Authentication username
          type: string
        from:
          $ref: definitions.yaml#/email
          description: The "from" address. Defaults to alerts@$clusterDomain.
          title: From address
        hello:
          description: The hostname to identify to the SMTP server.
          title: Hello
          type: string
        smarthost:
          description: The smtp host:port combination.
          pattern: ^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9]):()([1-9]|[1-5]?[0-9]{2,4}|6[1-4][0-9]{3}|65[1-4][0-9]{2}|655[1-2][0-9]|6553[1-5])$
          type: string
          title: Smart Host
      required:
        - smarthost
      type: object
      x-externalDocsPath: docs/console/settings/smtp
  type: object
