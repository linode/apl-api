Settings:
  x-acl:
    admin: [read-any, update-any]
    team: []
  additionalProperties: false
  properties:
    alerts:
      $ref: definitions.yaml#/alerts
    azure:
      description: Azure specific configuration.
      properties:
        appgw:
          properties:
            isManaged:
              default: true
              description: Is this appgw installed as AKS addon?
              type: boolean
          type: object
        monitor:
          $ref: definitions.yaml#/azureMonitor
        resourceGroup:
          description: An Azure resource group.
          type: string
        subscriptionId:
          description: An Azure subscription ID.
          type: string
        tenantId:
          description: An Azure tenant ID.
          type: string
      required:
        - resourceGroup
        - subscriptionId
        - tenantId
      type: object
    customer:
      additionalProperties: false
      properties:
        name:
          type: string
      type: object
    dns:
      properties:
        zones:
          description: Extra dns zones that the cluster can administer (see dns). Team services can use this to publish their URLs on.
          items:
            type: string
          type: array
        domain:
          type: string
          description: A fqdn for the cluster
      oneOf:
        - title: aws
          properties:
            aws:
              properties:
                region:
                  type: string
              required:
                - region
              type: object
          type: object
          required:
            - aws
        - title: azure
          properties:
            azure:
              properties:
                cloud:
                  title: Cloud
                  type: string
                  description: Azure Cloud
                resourceGroup:
                  title: Resource group
                  type: string
                  description: Azure resource group
                hostedZoneName:
                  title: Hosted zone name
                  type: string
                tenantId:
                  title: Tenant ID
                  type: string
                  description: Azure tenant ID
                subscriptionId:
                  title: Subscription ID
                  type: string
                  description: Azure subscription ID
                aadClientId:
                  title: Client ID
                  type: string
                  description: Azure Application Client ID
                aadClientSecret:
                  title: Client secret
                  type: string
                  description: Azure Application Client Secret
                useManagedIdentityExtension:
                  title: Using managed identities?
                  type: boolean
                  description: If you use Azure MSI, this should be set to true
                  default: false
              required:
                - resourceGroup
                - tenantId
                - subscriptionId
                - aadClientId
                - aadClientSecret
              type: object
          type: object
          required:
            - azure
        - title: google
          properties:
            google:
              properties:
                serviceAccountKey:
                  description: A service account key for managing a DNS zone.
                  type: string
                project:
                  type: string
              required:
                - serviceAccountKey
                - project
              type: object
          type: object
          required:
            - google
      required:
        - domain
      type: object
    kms:
      $ref: 'definitions.yaml#/kms'
    home:
      $ref: definitions.yaml#/alerts
    oidc:
      additionalProperties: false
      description: 'Holds many parts used in different locations. Please see keycloak, istio and oauth-proxy all consuming parts.'
      properties:
        adminGroupID:
          type: string
        apiUrl:
          $ref: 'definitions.yaml#/url'
        authUrl:
          $ref: 'definitions.yaml#/url'
        clientID:
          type: string
        clientSecret:
          type: string
        issuer:
          $ref: 'definitions.yaml#/url'
        scope:
          type: string
        teamAdminGroupID:
          type: string
        tenantID:
          type: string
        tokenUrl:
          $ref: 'definitions.yaml#/url'
        usernameClaimMapper:
          type: string
          description: Claim name used by Keycloak to identify incoming users from identity provider
        subClaimMapper:
          type: string
          description: Select OIDC claim to be used as a unique user identifier
          default: sub
      type: object
    otomi:
      additionalProperties: false
      properties:
        additionalClusters:
          type: array
          items:
            $ref: cluster.yaml#/Cluster
            required:
              - domainSuffix
              - name
              - provider
        hasCloudLB:
          default: false
          description: Set this to true when an external LB exists or needs to be started (AWS ALB, Azure AppGW, Google Apigee). This will then be configured through ingress controllers. Expects existing LBs to terminate https. Currently this is only working correctly for Azure, and not for AWS and Google. AWS is close to completion.
          type: boolean
        isHomeMonitored:
          default: false
          description: Whether this cluster is home monitored (like when under a Premium SLA). Sends criticals home.
          type: boolean
        isManaged:
          default: true
          description: Whether masters are managed and not under control. Set this to false when onprem.
          type: boolean
        isMultitenant:
          default: true
          description: Whether to separate team metrics and logs. Disabling this lets everybody be admin and see everything.
          type: boolean
        mode:
          default: ee
          description: The otomi-core edition. Either community edition (ce) or enterprise edition (ee).
          enum:
            - ce
            - ee
          type: string
        pullSecret:
          default: ''
          description: The pullsecret to deploy the Otomi API and Console. Requires an Otomi license.
          type: string
        teamPrefix:
          default: team-
          description: The prefix to use in URLs for team domains.
          pattern: ^[a-z]+[-]{1}$
          type: string
        addons:
          description: Manage addon configuration
          additionalProperties: false
          properties:
            conftest:
              properties:
                enabled:
                  type: boolean
                  default: true
                  description: Use this flag to enable conftest for policy validation
              type: object
          type: object
      type: object
    smtp:
      additionalProperties: false
      properties:
        auth_identity:
          type: string
        auth_password:
          type: string
        auth_secret:
          type: string
        auth_username:
          type: string
        from:
          $ref: definitions.yaml#/email
          description: The "from" address. Defaults to alerts@$clusterDomain.
        hello:
          type: string
        smarthost:
          $ref: definitions.yaml#/hostPort
          description: The smtp host:port combination.
      required:
        - smarthost
      type: object
  type: object
