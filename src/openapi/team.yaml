TeamSelfService:
  title: Team Permissions
  description: Grant team permissions to modify certain configuration parameters.
  type: object
  properties:
    teamMembers:
      title: Team Members Permissions
      type: object
      properties:
        createServices:
          title: Create Services
          type: boolean
          default: false
          description: Permission to create services.
        editSecurityPolicies:
          title: Edit Security Policies
          type: boolean
          default: false
          description: Permission to edit security policies.
        useCloudShell:
          title: Use Cloud Shell
          type: boolean
          default: false
          description: Permission to use the cloud shell.
        downloadKubeconfig:
          title: Download Kubeconfig
          type: boolean
          default: false
          description: Permission to download the kubeconfig.
        downloadDockerLogin:
          title: Download Docker Login
          type: boolean
          default: false
          description: Permission to download the docker login configuration.
      required:
        - createServices
        - editSecurityPolicies
        - useCloudShell
        - downloadKubeconfig
        - downloadDockerLogin
  x-acl:
    platformAdmin: [read-any, update-any]
    teamAdmin: [read]
    teamMember: [read]

Team:
  properties:
    id:
      $ref: 'definitions.yaml#/idName'
      title: ID
    name:
      $ref: 'definitions.yaml#/idName'
      title: Name
      description: A team name
    oidc:
      properties:
        groupMapping:
          description: An OIDC group (name/id) granting access to this Team.
          title: Group mapping
          type: string
      title: OIDC
      type: object
    password:
      type: string
      writeOnly: true
      x-acl:
        platformAdmin: [read-any, update-any]
        teamAdmin: []
        teamMember: []
    managedMonitoring:
      title: Managed monitoring
      description: 'Activate a platform managed Grafana or Alertmanager instance.'
      properties:
        grafana:
          type: boolean
          default: false
        alertmanager:
          type: boolean
          default: false
    alerts:
      $ref: 'definitions.yaml#/alerts'
    resourceQuota:
      $ref: 'definitions.yaml#/resourceQuota'
    networkPolicy:
      title: Network policies
      properties:
        ingressPrivate:
          title: Ingress control
          description: When enabled Team Workloads will be bound by ingress network policies. Turning this off introduces a security risk!
          type: boolean
          default: true
        egressPublic:
          title: Egress control
          description: When enabled all egress traffic will be limited to pre-defined endpoints. Turning this off introduces a security risk!
          type: boolean
          default: true
      type: object
    selfService:
      $ref: 'team.yaml#/TeamSelfService'
  required:
    - name
  x-acl:
    platformAdmin:
      - delete-any
      - read-any
      - create-any
      - update-any
    teamAdmin:
      - read
      - update
    teamMember:
      - read
  type: object
  x-externalDocsPath: platform-teams

AplTeamSpec:
  type: object
  properties:
    oidc:
      properties:
        groupMapping:
          description: An OIDC group (name/id) granting access to this Team.
          title: Group mapping
          type: string
      title: OIDC
      type: object
    password:
      type: string
      writeOnly: true
      x-acl:
        platformAdmin: [read-any, update-any]
        teamAdmin: []
        teamMember: []
    managedMonitoring:
      title: Managed monitoring
      description: 'Activate a platform managed Grafana or Alertmanager instance.'
      properties:
        grafana:
          type: boolean
          default: false
        alertmanager:
          type: boolean
          default: false
    alerts:
      $ref: 'definitions.yaml#/alerts'
    resourceQuota:
      $ref: 'definitions.yaml#/resourceQuota'
    networkPolicy:
      title: Network policies
      properties:
        ingressPrivate:
          title: Ingress control
          description: When enabled Team Workloads will be bound by ingress network policies. Turning this off introduces a security risk!
          type: boolean
          default: true
        egressPublic:
          title: Egress control
          description: When enabled all egress traffic will be limited to pre-defined endpoints. Turning this off introduces a security risk!
          type: boolean
          default: true
      type: object
    selfService:
      $ref: 'team.yaml#/TeamSelfService'
