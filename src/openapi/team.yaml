TeamSelfService:
  title: Team self service flags
  description: Grant team permissions to modify certain configuration parameters.
  type: object
  properties:
    service:
      type: array
      items:
        type: string
        enum: [ingress, networkPolicy]
      x-allow-values:
        ingress:
          type: 'cluster'
        networkPolicy:
          ingressPrivate:
            mode: 'DenyAll'
      default: [ingress, networkPolicy]
      uniqueItems: true
    team:
      type: array
      items:
        type: string
        # downloadKubeConfig - is an action that a user can perform, not an attribute of the input form
        enum: [alerts, backup, oidc, resourceQuota, downloadKubeConfig, downloadDockerConfig, networkPolicy]
      uniqueItems: true
    apps:
      type: array
      items:
        type: string
        enum: [argocd, gitea]
      default: []
      uniqueItems: true
  x-acl:
    admin: [read-any, update-any]
    team: [read]

Team:
  properties:
    id:
      $ref: definitions.yaml#/idName
      title: ID
    name:
      $ref: definitions.yaml#/idName
      title: Name
      description: A team name
    oidc:
      properties:
        groupMapping:
          description: An OIDC group name/id granting access to this team
          title: Group mapping
          type: string
      title: OIDC
      type: object
    password:
      type: string
      writeOnly: true
      x-acl:
        admin: [read-any, update-any]
        team: []
    alerts:
      $ref: definitions.yaml#/alerts
    resourceQuota:
      $ref: definitions.yaml#/resourceQuota
    azureMonitor:
      $ref: definitions.yaml#/azureMonitor
    monitoringStack:
      title: Private team monitoring
      properties:
        enabled:
          description: When enabled, a private Prometheus and Grafana instance is provisioned.
          title: Enabled
          type: boolean
          default: true
    backup:
      title: Backup configuration
      properties:
        enabled:
          description: Enable to create backups for the team based on the desired configuration.
          type: boolean
          default: false
        schedule:
          $ref: definitions.yaml#/backupSchedule
        snapshotVolumes:
          title: Snapshot Volumes
          description: Whether or not to snapshot volumes.
          type: boolean
          default: false
        labelSelector:
          title: Label Selector
          $ref: definitions.yaml#/labels
          description: (Optional) Individual objects must match this label selector to be included in the backup.
        includedResources:
          title: Included Resources
          description: Resources to include in the backup.
          items:
            enum:
              - pv
              - secret
              - configmap
              - deployment
              - service
              - statefulset
              - replicaset
            type: string
          type: array
          uniqueItems: true
        
        


    

    networkPolicy:
      properties:
        ingressPrivate:
          title: Network policies
          description: When enabled team services will be bound by (ingress) network policies. Turning this off introduces a security risk!
          type: boolean
          default: true
        egressPublic:
          title: Egress control
          description: When enabled team service egress traffic will be limited to pre-defined endpoints. Turning this off introduces a security risk!
          type: boolean
          default: true
      type: object
    selfService:
      $ref: team.yaml#/TeamSelfService
  required:
    - name
  x-acl:
    admin:
      - delete-any
      - read-any
      - create-any
      - update-any
    team:
      - read-any
      - update
  type: object
  x-externalDocsPath: docs/console/teams
