idName: &idName
  description: A lowercase name that starts with a letter and may contain dashes.
  pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
  type: string

Team:
  x-externalDocsPath: docs/configuring-teams
  x-acl:
    admin: [delete-any, read-any, create-any, update-any]
    team: [read-any, update]
  properties:
    id:
      <<: *idName
      title: ID
      x-acl:
        admin: [read]
        team: [read]
    name:
      <<: *idName
      title: Name
      example: 'otomi'
      x-acl:
        admin: [create, read]
        team: [read]
      description: A team name
    oidc:
      title: OIDC
      properties:
        groupMapping:
          title: Group mapping
          type: string
          description: 'An OIDC group name/id granting access to this team'
      type: object
    password:
      type: string
      # description: "A secret that is used access multi-tenant log aggregation system (Loki)"
      writeOnly: true
    alerts:
      title: Alerting endpoints
      properties:
        receivers:
          title: Receivers
          type: array
          items:
            type: string
            enum:
              - slack
              - msteams
              - email
          uniqueItems: true
        slack:
          title: Slack
          properties:
            url:
              title: Web hook
              type: string
              description: Slack web hook. If none is given the global one is used.
            channel:
              title: Channel for non-criticals
              type: string
              description: Slack channel for non-criticals. If none is given the global one is used, which defaults to 'mon-otomi'.
            channelCrit:
              title: Channel for criticals
              type: string
              description: Slack channel for critical alerts. If none is given the global one is used, which defaults to 'mon-otomi-crit'.
          type: object
        msteams:
          title: Microsoft Teams
          properties:
            lowPrio:
              title: Low prio webhook
              type: string
              description: The low prio web hook
            highPrio:
              title: High prio webhook
              type: string
              description: The high prio web hook
          type: object
        email:
          title: Email
          properties:
            nonCritical:
              title: Non criticals
              type: string
              description: One or more email addresses (comma separated) for non-critical events.
            critical:
              title: Criticals
              type: string
              description: Email addresses (comma separated) for critical events.
          type: object
      type: object
    # azureMonitor:
    #   $ref: definitions.yaml#/azureMonitor
  required:
    - name
    - password
  type: object
